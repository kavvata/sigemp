<div x-data="{ query: '', selected: '', show: false}"
     @submit.prevent="$el.closest('form').querySelector('.autocomplete-search').remove()"
     tabindex="0"
     @select-first="selected = document.querySelector('#result-list').children[0].id; query=document.querySelector('#result-list').children[0].innerHTML; show = false"
     @click.outside="show = false"
     class="relative w-full">
    <input type="text" x-model="selected" name="aluno"  hidden />
    <div class="flex flex-row w-full justify-between min-w-0 rounded-lg border border-gray-300 bg-gray-50 p-2.5 text-sm text-gray-900 has-[:focus]:ring-2 has-[:focus]:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:has-[:focus]:ring-blue-500"
         @select-first="selected = document.querySelector('#result-list').children[0].id; query=document.querySelector('#result-list').children[0].innerHTML; show = false">
        <input type="text"
               name="q"
               class="autocomplete-search border-none bg-transparent shadow-none p-0 text-sm focus:outline-none focus:ring-0 w-full"
               x-model="query"
               hx-get="/search/"
               @keydown.enter.prevent="$dispatch('select-first'); $el.blur()"
               @keydown.escape.prevent="show = false; $el.blur()"
               @keyup="show = true"
               @focus="show = true"
               @blur="show = false"
               hx-trigger="focus, keyup changed delay:300ms"
               hx-include="[name=q]"
               hx-target="#result-list"
               hx-swap="innerHTML"
               placeholder="Search..." />
        <i class="material-symbols-outlined text-sm transform transition-transform duration-200 dark:text-gray-400"
           :class="{ 'rotate-180': show }">expand_more</i>
    </div>
    <ul x-show="show"
        x-transition.duration.300ms.origin.top
        @keyup.escape="show = !show"
        id="result-list"
        class="absolute shadow-lg block mt-1 w-full min-w-0 rounded-lg border border-gray-300 bg-gray-50 text-sm text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 max-h-60  overflow-auto">
    </ul>
</div>
